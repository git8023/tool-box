!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("vue-class-component"),require("vuex-class")):"function"==typeof define&&define.amd?define(["exports","vue-class-component","vuex-class"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).ToolBox={},t.vueClassComponent,t.vuexClass)}(this,(function(exports,vueClassComponent,vuexClass){"use strict";class Cast{static get nil(){}static get anyA(){return[]}static get anyO(){return this.as()}static as(t={}){return t}static error(t){return t instanceof Error?t:"string"==typeof t?Error(t):Error("undefined")}static asSafety(t,e={},r=!0){return new Proxy(t??Cast.as(e),{set:()=>r})}}class Dates{static datePoF(t,e,r){const s=this.dateParse(t,e);return s&&validators.is(r,"String")&&r.trim().length?this.dateFmt(s,r):s}static dateParse(dateStr,pattern){const metaPatterns={metas:{y:{name:"Year",setYear:function(t){t.setFullYear(this.original||0)}},M:{name:"Month",setMonth:function(t){t.setMonth(isNaN(this.original)?0:this.original-1)}},d:{name:"Day",setDay:function(t){t.setDate(this.original||0)}},H:{name:"Hour",setHour:function(t){t.setHours(this.original||0)}},m:{name:"Minute",setMinute:function(t){t.setMinutes(this.original||0)}},s:{name:"Second",setSecond:function(t){t.setSeconds(this.original||0)}},S:{name:"Millisecond",setMillisecond:function(t){t.setMilliseconds(this.original||0)}}},setValues:function(t){return this.metas.y.setYear(t),this.metas.M.setMonth(t),this.metas.d.setDay(t),this.metas.H.setHour(t),this.metas.m.setMinute(t),this.metas.s.setSecond(t),this.metas.S.setMillisecond(t),t},validate:function(originDateStr,tgtPattern){const NUMBER_PATTERN="\\d",MX_PATTERN="\\d+";let replacedPattern=(tgtPattern||"")+"";if(!replacedPattern)return!1;const metasStr=[];Jsons.foreach(this.metas,(t=>{metasStr.push(t.index)})),replacedPattern=replacedPattern.replace(/\//g,"\\/"),Arrays.foreach(metasStr,(el=>{replacedPattern=replacedPattern.replace(eval(`(/${el.item}/g)`),"S"===el.item?MX_PATTERN:NUMBER_PATTERN)})),replacedPattern=replacedPattern.replace(/\\\\/g,"\\").replace(/\//g,"/");const result=eval("(/^"+replacedPattern+"$/)").test(originDateStr);if(result){const _this=this,metasGroup=metasStr.join(""),groupRegExp=eval("(/(["+metasGroup+"])\\1*/g)"),onlyNumberDateStr=originDateStr.replace(/\D+/g,"");let originValueIndex=0;Jsons.foreach(tgtPattern.match(groupRegExp),(function(t){const e=_this.metas[t.item[0]];e.beginIndex=tgtPattern.indexOf(t.item),e.pLength=t.item.length,"S"!==t.item[0]?e.original=onlyNumberDateStr.substring(originValueIndex,originValueIndex+e.pLength):e.original=onlyNumberDateStr.substring(originValueIndex),originValueIndex+=e.pLength}))}return result}},success=metaPatterns.validate(dateStr,pattern);return success?metaPatterns.setValues(new Date):null}static dateFmt(t,e){if(Validation.isNil(t))return"";if((Validation.is(t,"Number")||Validation.is(t,"String"))&&(t=new Date(t)),Validation.isNot(t,"Date"))throw new Error("Error Type: Parameters 'date' must be a Date type");return function(t){const e=this;t=t||"yyyy-MM-dd HH:mm:ss";const r=e.getTime();if(isNaN(r))return;const s={"M+":e.getMonth()+1,"d+":e.getDate(),"H+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(const e in s)new RegExp("("+e+")").test(t)&&(t=1===RegExp.$1.length?t.replace(RegExp.$1,s[e].toString()):t.replace(RegExp.$1,("00"+s[e]).substr(s[e].toString().length)));return t}.call(t,e)}static dateDiff(t,e=new Date){return Validation.isNot(t,"Date")&&Validation.isNot(e,"Date")?NaN:t.getTime()-e.getTime()}static nowFmt(t){return this.dateFmt(new Date,t)}}var LogLevel;exports.LogLevel=void 0,LogLevel=exports.LogLevel||(exports.LogLevel={}),LogLevel[LogLevel.TRACE=0]="TRACE",LogLevel[LogLevel.DEBUG=1]="DEBUG",LogLevel[LogLevel.INFO=2]="INFO",LogLevel[LogLevel.WARN=3]="WARN",LogLevel[LogLevel.ERROR=4]="ERROR",LogLevel[LogLevel.FATAL=5]="FATAL",LogLevel[LogLevel.OFF=6]="OFF";const MAX_NAME_LENGTH=Object.keys(exports.LogLevel).filter((t=>isNaN(Number(t)))).sort(((t,e)=>t.length-e.length)).pop().length,ConsoleFontColor={TRACE:"#999",DEBUG:"#333",INFO:"#40c740",WARN:"#8f8f00",ERROR:"#ac001c",FATAL:"#ff0000",OFF:"transparent"};class ConsoleLogger{static _instance;static get instance(){return ConsoleLogger._instance||(ConsoleLogger._instance=new ConsoleLogger),ConsoleLogger._instance}level=exports.LogLevel.TRACE;cacheSize=200;enableTrace=!1;cacheStore=[];trace=(...t)=>this.log(exports.LogLevel.TRACE,Array.from(t),!0);debug=(...t)=>this.log(exports.LogLevel.DEBUG,Array.from(t));info=(...t)=>this.log(exports.LogLevel.INFO,Array.from(t));warn=(...t)=>this.log(exports.LogLevel.WARN,Array.from(t));error=(...t)=>this.log(exports.LogLevel.ERROR,Array.from(t));fatal=(...t)=>this.log(exports.LogLevel.FATAL,Array.from(t));constructor(){exports.LogLevel.DEBUG===this.level&&(window.logs=this,this.dir={LogLevel:exports.LogLevel,ConsoleFontColor:ConsoleFontColor,filter:t=>{this.cacheStore.filter((e=>e.lv===t)).map((t=>t.args)).forEach(this.print.bind(this))}})}log(t,e,r=!1){if(t<this.level)return;this.enableTrace=r;const s=exports.LogLevel[t],i=ConsoleFontColor[s];let n=0;Arrays.foreach(e,(t=>{const e=Validation.is(t.item,"String");return e&&n++,e}));const o=[`%c[${s.padStart(MAX_NAME_LENGTH)}]%c -- [${Dates.nowFmt("yyyy-MM-dd HH:mm:ss:S")}]:`+" %s".repeat(n),`padding:5px; background:${i}; color:#fff; font-size:12px;`,`color:${i}; border:0;background:transparent; font-size:14px;`,...e];this.cache(t,o),this.print(o)}print(t){const e=(((new Error).stack.split("\n")[4]||"").match(/\((.*)\)/)||[])[1]||"";console.log(...t,e);this.level<=exports.LogLevel.DEBUG&&this.enableTrace&&(console.groupCollapsed("Debug Trance"),console.trace(),console.groupEnd())}cache(t,e){for(this.cacheStore.push({lv:t,args:e});this.cacheStore.length>this.cacheSize;)this.cacheStore.pop()}}const Logs=ConsoleLogger.instance;class Promises{static from(t){return Promise.resolve(t)}static of(t){return Validation.isFunction(t)?new Promise(((e,r)=>{try{e(Functions.call(t))}catch(t){r(t)}})):this.from(t)}static control(t){const e=Cast.as(),r=Promise.race([t||Promise.resolve(void 0),new Promise(((t,r)=>{e.abort=r})).catch((()=>Logs.debug("异步数据被取消!")))]);return r.abort=()=>e.abort(),r}}class Functions{static call(t,...e){return this.exec(t,void 0,...e)}static exec(t,e,...r){return t&&Validation.isFunction(t)?Cast.as(t).call(e,...r):void 0}static execOrGetter(t,...e){return t instanceof Function?Functions.call(t,...e):t}static execOrAsyncGetter(t,...e){if(t instanceof Promise)return t;const r=this.execOrGetter(t,...e);return Promises.from(r)}static timer(t,e=!1,r=0,s=!1,...i){s&&(Functions.call(t,...i),!e)||setTimeout((()=>{Promises.of((()=>t(...i))).then((()=>{e&&this.timer(t,e,r)}))}),r)}}class Objects{static equals(t,e,r){if(r){return Jsons.get(t,`${String(r)}`)===Jsons.get(e,`${String(r)}`)}return t===e}}class Switcher{condition;valueInner;constructor(t,e){this.condition=t,this.setValue(t,e)}case(t,e){return this.condition||this.setValue(t,e),this}otherwise(t){return this.setValue(!this.condition,t)}throw(t,e){if(this.condition)return this;if(t)throw Cast.error(e);return this}otherwiseThrow(t){return this.throw(!0,t)}broken(t,e,r){if(!this.condition)throw Cast.error(r);return this.setValue(t,e)}getValue(t){return Validation.isNot(t,"Function")?this.valueInner:t(this.valueInner)}setValue(t,e){return this.condition=t??this.condition,this.condition&&(this.valueInner=Functions.execOrGetter(e)),this}}class Condition{c;negativeDesc;positiveDesc;constructor(t=!0){this.c=t}and(t,e,r,s=!0,i="CHAIN"){return this.exec(this.c&&t,e,r,s,i,t)}or(t,e,r,s=!0,i="CHAIN"){return this.exec(this.c||t,e,r,s,i,t)}not(t,e,r=!0,s="CHAIN"){return this.exec(!this.c,t,e,r,s)}result(t){return Functions.call(t,this.c,this.positiveDesc,this.negativeDesc)}exec(t,e,r,s,i,n){switch(t?this.positiveDesc=e:this.negativeDesc=r,this.c=s?t:this.c,i){case"PARAMETER":return n??this.c;case"CONDITION":return this.c;default:return this}}}class Logics{static case(t,e){return new Switcher(t,e)}static condition(t=!0){return new Condition(t)}}class Builders{static getterSelf(t){return e=>t??e}static getter(t){return e=>Jsons.get(e,t.toString())}static iteratorGetter(t){return e=>Validation.notEmpty(t)?Jsons.get(e.item,t.toString()):e.item}static equalsOther(t,e){return r=>Objects.equals(r,t,e)}static equalsOtherElement(t,e){return r=>{if(r.item===t)return!0;if("string"==typeof e)return Objects.equals(r.item,t,e);if(Validation.isFunction(e)){return!!Functions.call(e,r,t)}return!1}}static iteratorMapper(t){return Validation.isOr(t,"String","Number")?Builders.iteratorGetter(t):t}static toArrayKeyMapperHandler(t,e="throw"){return Logics.case(t instanceof Function,(()=>t)).case(Validation.is(t,"String"),(()=>Builders.iteratorGetter(t))).case("element"===e,(()=>Builders.iteratorGetter())).otherwiseThrow(Error("predictor无效. 仅支持String|Function")).getValue()}static runner(t,...e){return Cast.as((()=>t(...e)))}}class Arrays{static toMap(t,e,r=!0,s){const i=Cast.anyO;if(Validation.nullOrUndefined(t,e))return i;const n=Builders.iteratorMapper(e);return t.forEach(((t,e)=>{const o=n({item:t,index:e});if(i[o]&&!r)throw new Error(`不允许重复Key [${String(o)}]`);i[o]=t;const a=Functions.call(s,t)||[];if(Validation.notEmpty(a)){const t=Arrays.toMap(a,o,r,s);Jsons.merge(t,i,r)}})),i}static intersectionSimple(t){if(!t||!t.length||Validation.isEmpty(t))return[];const e=t[0];if(1===t.length)return e;t.sort(((t,e)=>t.length-e.length));return(t.pop()||[]).filter((e=>{let r=!0;return t.forEach((t=>{r&&(r=r&&t.includes(e))})),r}))}static intersection(t,e,r){if(t===e)return t;const s=Builders.toArrayKeyMapperHandler(r,"element"),i=[];return Validation.isNot(t,"Array")||Validation.isEmpty(t)||Validation.isNot(e,"Array")||Validation.isEmpty(e)?i:Logics.case(t.length>=e.length,{src:t,other:e}).otherwise({src:e,other:t}).getValue((({src:t,other:e})=>{const r=[];return this.foreach(t,(t=>{const i=s(t);this.foreach(e,(e=>{const n=s(e);i===n&&r.push(t.item)}))})),r}))}static seek(t,e,r){let s=Cast.nil;return Arrays.foreach(t,(t=>{if(e(t))return s=t,!1;const i=Functions.call(r,t);return!Validation.is(i,"Array")||(s=Arrays.seek(i,e,r),!Validation.notEmpty(s))})),s}static foreach(t,e){if(Validation.isNot(t,"Array"))return t;for(let r=0,s=t.length;r<s&&!1!==e({item:t[r],index:r});r++);return t}static pushUnique(t,e,r){const s=Arrays.index(t,e,r);return-1!==s.index?s.index:t.push(e)-1}static index(t,e,r){let s=-1;const i=Builders.equalsOtherElement(e,r);Arrays.foreach(t,(t=>{if(i(t))return s=t.index,!1}));const n=Logics.case(-1!==s,t[s]).getValue();return{index:s,item:n}}static find(t,e,r){return Arrays.index(t,e,r)}static concat(t,e){if(Validation.isNot(t,"Array")||Validation.isNot(e,"Array"))throw new Error("无效数组参数");return Array.prototype.push.apply(t,e),t}static remove(t,e,r){const s=Arrays.index(t,e,r);return Logics.case(this.validateIndex(s),(()=>t.splice(s.index,1)[0])).getValue()}static removeAll(t,e){return t.filter((t=>!e.includes(t)))}static contains(t,e,r){return this.validateIndex(Arrays.index(t,e,r))}static filter(t,e){let r=[];Arrays.foreach(t,(t=>{!1===Functions.call(e,t)&&r.push(t.index)})),r=r.reverse(),Arrays.foreach(r,(e=>{t.splice(e.index,1)}))}static group(t,e){const r=Cast.as(),s=Builders.toArrayKeyMapperHandler(e);return Arrays.foreach(t,(t=>{const e=s(t);Jsons.computeIfAbsent(r,e,[]).push(t.item)})),r}static extractProps(t,e){const r=[];return Arrays.foreach(t,(t=>{const s=Jsons.get(t.item,e);Validation.notEmpty(s)&&r.push(s)})),r}static unique(t,e=!0,r){if(0===t.length)return t;const s=Builders.toArrayKeyMapperHandler(r,"element"),i=[],n=[];return this.foreach(t,(t=>{const e=s(t);n.includes(e)||(n.push(e),i.push(t.item))})),e&&(t.length=0,Arrays.concat(t,i)),t}static genNums(t,e){if(0>=e-t)return[];return[...new Array(e+1).keys()].slice(t)}static tree(t,e,r,s,i=!1){const n=Arrays.toMap(t,s),o=[];return Arrays.foreach(t,(t=>{const i=Jsons.get(t.item,r.toString()),a=n[i];if(!a)return;o.push(Jsons.get(t.item,s.toString()));const c=Jsons.computeIfAbsent(a,e,[]);c.push(t.item),a[e]=Arrays.unique(c)})),i&&Arrays.foreach(o,(t=>{delete n[t.item]})),Object.values(n)}static flatTreeSR(t,e,r=!0,s=!1){const i=r?[t]:[];return Validation.isNot(t,"Object")||(Arrays.foreach(t[e],(t=>{i.push(t.item);const r=Arrays.flatTreeSR(t.item,e,!1,s);Validation.notEmpty(r)&&i.push(...r)})),s&&delete t[e]),i}static flatTreeMR(t,e,r=!0,s=!1,i){const n=[];return this.foreach(t,(t=>{const i=this.flatTreeSR(t.item,e,r,s);this.concat(n,i)})),i?this.unique(n,!1,i):n}static validateIndex(t){return 0<=t.index}}class BError extends Error{constructor(t){super(BError.isError(t)?t.message:t),this.name="BError"}static from(t){return this.isError(t)?t:new BError(t)}static isError(t){return Validation.is(t,"Error")}static iff=(t,e)=>{t||this.throwError(e)};static throwError=t=>{throw this.from(t)}}class AsyncArrayStream{cursor=0;events={};array$;elements;result;isOver=!1;brokenInfo;brokenType;delegateResult;waitPromise;constructor(t){this.init(t)}static from(t){return new AsyncArrayStream(t)}onBegin(t){return this.events.begin=t,this}onElement(t){return this.events.element=t,this}onEmpty(t){return this.events.empty=t,this}onDone(t){return this.events.done=t,this}next(){return Functions.execOrAsyncGetter((()=>{if(this.isOver)return Promise.reject("数据已经处理完成");if(0===this.cursor&&(this.isOver=!1===Functions.call(this.events.begin,this),this.isOver))return;const t=this.elements||[];if(0===t.length){const t=Functions.execOrAsyncGetter(this.events.empty,this);return Validation.isNil(t)?void(this.isOver=!0):(this.reset(),this.array$=t,this.next())}if(this.cursor===t.length)return;const e=t[this.cursor],r={index:this.cursor++,item:e,self:this,broken:this.broken.bind(this)},s=Functions.call(this.events.element,r);return Functions.execOrAsyncGetter(s).then((t=>!1===t?(Logs.debug(`元素迭代返回结果:[${t}], 是否终止后续处理:[${!t}]`,r),void this.broken({...r,self:void 0},"ELEMENT_ITERATOR_HANDLE:FALSE")):this.next()))}))}broken(t,e="MANUAL"){this.isOver=!0,this.brokenInfo=t,this.brokenType=e}getResult(){return new Promise((t=>this.delegateResult=t))}init(t){return this.reset(),this.array$=Functions.execOrAsyncGetter(t),this.await()}reset(){this.cursor=0,this.isOver=!1,this.result=void 0}await(){return this.waitPromise&&this.waitPromise.abort(),this.waitPromise=Promises.control(this.array$.then((t=>(this.elements=t,this.next()))).then((()=>{this.result=Functions.call(this.events.done,this),this.events.done=void 0,this.callDelegateResult()})).catch((t=>{this.catch(t)}))),this.waitPromise}catch(t){const e={self:this,error:BError.from(t)};this.result=Functions.call(this.events.error,e),this.broken(t),this.callDelegateResult()}callDelegateResult(){const t={result:this.result,broken:this.brokenInfo,brokenType:this.brokenType};Functions.call(this.delegateResult,t),this.delegateResult=void 0}}class PropChains{origin;hierarchy;expectType;prop;value;next;static getArrOgnlVal(t,e){const r=e.indexOf("[");let s;if(0<r){s=t[e.substring(0,r)]}else s=t;const i=e.substring(r);if(!/^(\[\d+])+$/.test(i))throw new Error("非法下标索引:"+i);const n=i.split("][");if(1===n.length){return s[+i.replace("[","").replace("]","")]}let o=s;return Arrays.foreach(n,(t=>{if(Validation.isNot(o,"Array"))return!1;o=o[parseInt((t+"").replace("[","").replace("]",""))]})),o}static getValue(t,e){if(Validation.nullOrUndefined(t))return null;if(1===(e=e.trim()).split(".").length){return/\[/.test(e)?PropChains.getArrOgnlVal(t,e):t?t[e]:t}const r=e.indexOf("."),s=e.substring(0,r),i=/\[\d+]/.test(s)?PropChains.getArrOgnlVal(t,s):t[s],n=e.substring(r+1);return PropChains.getValue(i,n)}static setValue(t,e,r){return Validation.isNil(t)?Cast.nil:PropChains.parse(e).setValue(t,r)}static parse(t,e=0){const r=new PropChains;r.origin=t,r.hierarchy=e;const s=!t.startsWith(".");if(BError.iff(s,"属性链无效"),t.startsWith("[")){const s=t.match(/^\[(.+)]/);r.prop=+s[1],BError.iff(Validation.is(r.prop,"Number"),`索引无效: ${t}, 期望类型 Number`),r.expectType="array";const i=t.indexOf("]"),n=t.substring(i+1);if(n){const t=n.replace(/^\./,"");r.next=PropChains.parse(t,e+1)}return r}const i=t.match(/^(.+)[.[]/)||[void 0,t];r.prop=i[1],r.expectType=r.prop.includes("[")?"array":"object";const n=t.substring(r.prop.length);if(n){const t=n.replace(/^\./,"");r.next=PropChains.parse(t,e+1)}return r}setValue(t,e){const r=t,s=r[this.prop],i=Object.prototype.toString.call(s);if(!this.next){switch(this.expectType){case"array":BError.iff(Validation.is(t,"Array"),`但类型错误. 期望[Array]实际[${i}]`);break;case"object":BError.iff(Validation.is(t,"Object"),`但类型错误. 期望[Object]实际[${i}]`)}return this.value=r[this.prop]=e,this.value}const n=Validation.notNil(s);switch(this.expectType){case"array":{const t=String(this.prop).split("[");if(2===t.length){if(this.value=r[this.prop]=r[this.prop]??[],this.next){const e=parseInt(t[1]);this.value=this.value[e]="object"===this.next.expectType?{}:[]}}else if(t.length>2){const e=t[0];let s=r[e]=r[e]??[];const i=parseInt(t.pop());for(let e=1;e<t.length;e++){const r=parseInt(t[e]),i=s[r];Validation.notNil(i)&&BError.iff(Validation.is(i,"Array"),`数据[${this.prop}]类型错误, 期望[[object Array]]实际[${Object.prototype.toString.call(i)}]`),s[r]=i??[],s=s[r]}this.next&&(this.value=s[i]="object"===this.next.expectType?{}:[])}else this.value=r[this.prop]=[];break}case"object":n?BError.iff(Validation.is(t,"Object"),`目标属性已存在, 但类型错误. 期望[Object]实际[${i}]`):this.value=r[this.prop]={}}return this.next.setValue(this.value,e)}}class Jsons{static merge(t,e,r=!0){const s=this.extractRepeatKeys(t,e);return s.length&&!r?s:(Object.assign(e,t),[])}static extractRepeatKeys(...t){const e=new Array,r=t||[];return void 0===r?[]:(r.forEach((t=>{Validation.notNil(t)&&e.push(Object.keys(t))})),Arrays.intersectionSimple(e))}static simpleClone(t){return Validation.isNil(t)?null:JSON.parse(JSON.stringify(t))}static foreach(t,e,r=!0){if(Validation.nullOrUndefined(t))return;const s=Object.keys(t);if(!r)return AsyncArrayStream.from(s).onElement((r=>{const s=e({item:t[r.item],index:r.item});s instanceof Promise?s.then(r.self.next.bind(r.self)).catch(r.self.broken.bind(r.self)):!1===s?r.self.broken(void 0,"ELEMENT_ITERATOR_HANDLE:FALSE"):r.self.next().then()})).onDone(Builders.getterSelf(t)).getResult();Arrays.foreach(s,(r=>e({item:t[r.item],index:r.item})))}static cover(t={},e=Cast.as({})){return this.foreach(e,(r=>{e[r.index]=t[r.index]??r.item})),e}static computeIfAbsent(t,e,r){if(Validation.is(t,"Array")&&t instanceof Array){const s=this.get(t,e);if(Validation.notNil(s))return s;const i=Functions.execOrGetter(r,t,e);return Jsons.set(t,e,i),i}if(e in t)return t[e];const s=Functions.execOrGetter(r,t,e);return Jsons.set(t,e,s),s}static compact(t,e=!1,r=!1,s=!1,i=!1,n=!1){if(!t)return t;const o=(t,e)=>{Validation.is(t,"Object")?delete t[e]:Validation.is(t,"Array")&&t.splice(+e,1)};return this.foreach(t,(a=>{if(Validation.isEmpty(a.item)){if(Validation.isNil(a.item)&&!r)return void o(t,a.index);if(Validation.is(a.item,"String")&&!s)return void o(t,a.index);if(Validation.is(a.item,"Object")&&!i)return void o(t,a.index);if(Validation.is(a.item,"Array")&&!n)return void o(t,a.index)}if(a.item instanceof Object&&e){if(a.item=this.compact(a.item),Validation.notEmpty(a.item))return void(t[a.index]=a.item);if(Validation.is(a.item,"Object")&&!i)return void o(t,a.index);if(Validation.is(a.item,"Array")&&!n)return void o(t,a.index)}})),t}static get(t,e){return PropChains.getValue(t,String(e))}static set(t,e,r){return PropChains.setValue(t,String(e),r)}static flat(t,e){const r=[];return this.foreach(t,(t=>{const s=e(t);r.push(s)})),r}static clear(t){return this.foreach(t,(e=>{t[e.index]=void 0})),t}}class Validation{static nullOrUndefined(...t){for(const e in t)if(!this.isNil(t[e]))return!1;return!0}static isNil(t){return null==t}static notNil(t){return!this.isNil(t)}static isTruthy(t){return!this.isFalsy(t)}static isFalsy(t){return!t}static is(t,e){return`[object ${e}]`===Object.prototype.toString.call(t)}static isOr(t,e,...r){(r=r||[]).push(e);for(const e of r)if(this.is(t,e))return!0;return!1}static isNot(t,e){return!this.is(t,e)}static isEmpty(t){return!!this.isNil(t)||(this.isOr(t,"Array","String")?0===t.length:!!this.is(t,"Object")&&0===Object.keys(t).length)}static notEmpty(t){return!this.isEmpty(t)}static isEq(t,e){return t===e||(!(!this.isNil(t)||!this.isNil(e))||JSON.stringify(t)===JSON.stringify(e))}static isFunction(t){return this.is(t,"Function")}static validate(t,e,r=!1){const s=Jsons.flat(e,(e=>({index:e.index,validate:e.item,iter:{item:Jsons.get(t,e.index),index:e.index}})));return r?AsyncArrayStream.from(s).onElement((t=>t.item.validate(Cast.as(t.item.iter)))).getResult().then((t=>Validation.isEmpty(t.broken)||Validation.isEmpty(t.brokenType))):s.reduce(((t,e)=>t&&!1!==e.validate(e.iter)),!0)}}class DataPoolKey{static AXIOS_SERVICE=Symbol("AXIOS_SERVICE");static AXIOS_EXTRACT_RESPONSE=Symbol("AXIOS_EXTRACT_RESPONSE")}class DataPool{static POOL=new Map;static get(t){return this.POOL.get(t)}static set(t,e){return this.POOL.set(t,e),this}}class Decorators{static class=t=>e=>t({target:e});static method=t=>(e,r)=>t({target:e,fnKey:r});static proxy=t=>Decorators.method((({target:e,fnKey:r})=>{const s=e[r];e[r]=function(...i){return t(this,{target:e,key:r,vof:s},i)}}))}class Request{static get axiosServe(){return DataPool.get("AXIOS_SERVICE")}static get extractResponseData(){return DataPool.get("AXIOS_EXTRACT_RESPONSE")||Builders.getterSelf()}}function Get(t){return(e,r)=>{e[r]=e=>{const r=setPathVariable(t,e=e||{});return Request.axiosServe.get(r,{params:e.params}).then(Request.extractResponseData)}}}function Delete(t){return generateWithPost(t,"delete")}function Post(t){return generateWithPost(t,"post")}function Put(t){return generateWithPost(t,"put")}function Filter(t){return Decorators.proxy(((e,{target:r,vof:s},i)=>s.bind(r)(...i).then((e=>Functions.call(t,e,i)))))}const setPathVariable=(t,e)=>{const r=e.pathVariables||{};return t.replaceAll(/({[^/]+})/g,(t=>{const e=t.match(/{(.+)}/)[1],s=r[e];return Validation.isNil(s)&&Logs.error(`缺少路径变量[${e}]配置`),String(s)}))},generateWithPost=(t,e)=>(r,s)=>{r[s]=r=>{const s=setPathVariable(t,r=r||{});return Request.axiosServe[e](s,r.params).then(Request.extractResponseData)}};class Strings{static replaceAll(t="",e={}){let r=t;return Jsons.foreach(e,(t=>{const e=new RegExp(`${t.index}`,"g");r=r.replace(e,t.item)})),r}static hasBlank(t=!0,...e){let r=!1;return Arrays.foreach(e,(e=>{if(this.isBlank(e.item,t))return r=!0,!1})),r}static isBlank(t,e=!0){return!Validation.isNot(t,"String")&&(!!Validation.isNil(t)||(e&&(t=t.trim()),0===t.length))}static guid(){const t=()=>(65536*(1+Math.random())|0).toString(16).substring(1);return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}static toString(t){return`${t}`}static trimToEmpty(t){return Validation.isNil(t)?"":t.toString().trim()}static html2text(t){let e=document.createElement("i");null!=e.textContent?e.textContent=t:e.innerText=t;const r=e.innerHTML;return e=null,r}static text2html(t){let e=document.createElement("i");e.innerHTML=t;const r=e.innerText||e.textContent;return e=null,r}}class Events{static debouncer(t=100,e){return Logs.info("[Events.debouncer] Execute debouncer"),vueClassComponent.createDecorator(((r,s)=>{const i=r.methods[s];e=e||`__${s}__${Strings.guid()}`,Logs.info("[Events.debouncer] Redefine function: ",s),r.methods[s]=function(...r){!0!==this[e]?(this[e]=!0,Logs.info("[Events.debouncer] Executing function: ",s),i.apply(this,r),setTimeout((()=>this[e]=!1),t)):Logs.info(`[Events.debouncer] 函数[${s}]需要等待上次防抖结束`)}}))}static debounceController(t,e=300){return vueClassComponent.createDecorator(((r,s)=>{const i=r.methods[s];if(!(i instanceof Function))throw new Error(`[Events.debounceController] 目标属性不是可执行函数: ${s}`);const n=r.methods[t];if(!(n instanceof Function))throw new Error(`[Events.debounceController] 中断函数无效, 指定属性不是可执行函数: ${String(t)}`);let o;r.methods[s]=function(...t){Logs.info(`[Events.debounceController] 函数[${s}]延迟执行 ${e} ms`),o=setTimeout((()=>i.bind(this)(...t)),e)},r.methods[t]=function(...e){Logs.info(`[Events.debounceController] 函数[${s}]执行被[${String(t)}]中断, 执行函数[${String(t)}]`),clearTimeout(o),n.bind(this)(...e)}}))}static log(t=!0,e=!0){return vueClassComponent.createDecorator(((r,s)=>{const i=r.methods[s];r.methods[s]=(...n)=>{const o=String(r.__file).split("/").pop(),a=`[${String(o).split(".")[0]}.${s}]`;t&&Logs.debug(a," Parameters: ",n);const c=i(...n);return e&&Validation.notNil(c)&&Logs.debug(a," Returns: ",c),c}}))}static lazy(t,e=10,r){return e=0<e?e:10,r=0<=(r=r??e)?r:e,vueClassComponent.createDecorator(((s,i)=>{const n=s.methods[i];s.methods[i]=function(...s){const i=this,o=()=>{const e=!!Functions.call(t,i);return e&&n.bind(i)(...s),e};setTimeout((()=>{o();const t=setInterval((()=>o()&&clearInterval(t)),r)}),e)}}))}static observe(t,e=!0,r=!1){return vueClassComponent.createDecorator(((s,i)=>{const n=s.methods[i];s.methods[i]=function(...s){const i=(t=t.bind(this))({stage:"before",args:s,thisArg:this});if(!e||!1!==i)try{const e=n.bind(this)(...s);if(Validation.is(e,"Promise"))return e.then((e=>{const s=t({stage:"after",data:e,thisArg:this});return r?s:e})).catch((e=>(t({stage:"error",error:e,thisArg:this}),Promise.reject(e))));const i=t({stage:"after",data:e,thisArg:this});return r?i:e}catch(e){return t({stage:"after",error:e,thisArg:this})}}}))}static observeRun(t){return this.observe((function({stage:e,thisArg:r}){const s=this;switch(e){case"before":return Functions.exec(Jsons.get(s,t.before),r);case"after":return void Functions.exec(Jsons.get(s,t.after),r);case"error":Functions.exec(Jsons.get(s,t.catcher),r);break;default:return void Logs.warn(`[Events] 未处理状态: ${e}`)}}),!1,!1)}static blink(t,e=10){return vueClassComponent.createDecorator(((r,s)=>{const i=r.methods[s];r.methods[s]=function(...r){this[t]=!1,Promises.of((()=>i.bind(this)(...r))).then((()=>Functions.timer((()=>this[t]=!0),!1,e)))}}))}}class Observer{static log(t=!0,e=!0){return(r,s)=>{const i=`[${s}] `,n=r[s];r[s]=(...r)=>{t&&Logs.debug(i," Parameters: ",r);const s=n(...r);return e&&Logs.debug(i," Returns: ",s),s}}}static lazy=(t,e=10,r)=>(e=0<e?e:10,r=0<=(r=r??e)?r:e,Decorators.method((({target:s,fnKey:i})=>{const n=s[i];s[i]=function(...s){const i=this,o=()=>{const e=t.bind(i)(i,...s);return e&&n.bind(i)(...s),e};setTimeout((()=>{o();const t=setInterval((()=>o()&&clearInterval(t)),r)}),e)}})))}class Storages{static $(t){const e={save(r,s){const i=e.get(r);return t.setItem(r,JSON.stringify(s)),i},get(e){const r=t.getItem(e);return Validation.isNil(r)?null:JSON.parse(r)},remove(r){const s=e.get(r);return t.removeItem(r),s},clear(){t.clear()}};return e}static $session=Storages.$(sessionStorage);static $local=Storages.$(localStorage)}function __decorate(t,e,r,s){var i,n=arguments.length,o=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,s);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(o=(n<3?i(o):n>3?i(e,r,o):i(e,r))||o);return n>3&&o&&Object.defineProperty(e,r,o),o}class StoreTools{static commit(t,e,r){t.commit(String(e),r)}static generateMutations(t){const e={};return Object.keys(t).forEach((t=>{e[t]=(e,r)=>e[t]=r})),e}static generateActions(t){const e={};return Object.keys(t).forEach((t=>{e[t]=(e,r)=>this.commit(e,t,r)})),e}static generateGetters(t){const e={};return Object.keys(t).forEach((t=>{e[t]=e=>e[t]})),e}static generate(t,e=!0,r="store"){const s=Functions.execOrGetter(t);let i={...s};return{namespaced:e,get state(){return i},mutations:{...StoreTools.generateMutations(i)},actions:{...StoreTools.generateActions(i)},getters:{...StoreTools.generateGetters(i)},__reset__(){i={...s}},__state_type__:Builders.getterSelf,__state_type_key__:Builders.getterSelf,__name__:r}}static namespaceT(t){return Cast.as(vuexClass.namespace(t))}static namespaceX=Cast.nil}__decorate([Decorators.proxy(((t,e,r)=>{const s=r[0];return StoreTools.namespaceT(s.__name__)}))],StoreTools,"namespaceX",void 0);class Broadcast{subscribers=new Map;emit(t,e){const r=this.get(t);return Arrays.foreach(r,(t=>{Functions.call(t.item,e)})),this}on(t,e,r=!1,s=0,...i){return this.get(t).push(e),r&&Functions.timer(e,!1,s,!1,...i),this}off(t,e){const r=this.get(t);return Arrays.remove(r,e),this}get(t){let e=this.subscribers.get(t);return e||this.subscribers.set(t,e=[]),e}}class Documents{static copyText(t){return navigator.clipboard.writeText(t).then((()=>(Logs.debug("[CodeHL] navigator.clipboard 复制成功!"),!0))).catch((()=>{const e=document.createElement("textarea");return e.value=t,e.select(),document.execCommand("copy"),Logs.debug("[CodeHL ] document.execCommand 复制成功"),!0}))}}class Reflections{static watchers=Symbol("watchers");static values=Symbol("values");static watched=Symbol("watched");static watch(t,e,r){const[s]=this.constValue(t,Reflections.watchers,{});s[e]=s[e]||[];const i=s[e];i.includes(r)||i.push(r);const[n,o]=this.constValue(t,Reflections.values,{});o&&Object.assign(n,t);const[a]=this.constValue(t,Reflections.watched,{});if(Reflect.has(a,e))return t;const c=Reflect.getOwnPropertyDescriptor(t,e)??{configurable:!0,enumerable:!0};return Reflect.defineProperty(t,e,{configurable:c.configurable,enumerable:c.enumerable,get:()=>n[e],set:t=>{const r=n[e];n[e]=t,i.forEach((s=>{try{s(t,r)}catch(t){console.warn(`观察者[${String(e)}]执行错误`,t,s)}}))}}),a[e]=!0,t}static constValue(t,e,r){if(r=t[e]??r,Reflect.has(t,e))return[r,!1];if(!Reflect.defineProperty(t,e,{value:r,configurable:!0,enumerable:!1,writable:!1}))throw Error("属性代理失败");return[r,!0]}}class Pending{asyncCall;conditions;awaits=Cast.anyO;constructor(t,e){this.asyncCall=t,this.conditions=e,this.init()}static create(t,...e){return new Pending(t,e??[])}complete(t){return Functions.call(this.awaits[t]),this}init(){const t=[];this.conditions.forEach((e=>{t.push(new Promise((t=>{this.awaits[e]=t})))})),Promise.all(t).then(this.asyncCall)}}exports.Arrays=Arrays,exports.AsyncArrayStream=AsyncArrayStream,exports.BError=BError,exports.Broadcast=Broadcast,exports.Builders=Builders,exports.Cast=Cast,exports.Condition=Condition,exports.ConsoleLogger=ConsoleLogger,exports.DataPool=DataPool,exports.DataPoolKey=DataPoolKey,exports.Dates=Dates,exports.Decorators=Decorators,exports.Delete=Delete,exports.Documents=Documents,exports.Events=Events,exports.Filter=Filter,exports.Functions=Functions,exports.Get=Get,exports.Jsons=Jsons,exports.Logics=Logics,exports.Logs=Logs,exports.Objects=Objects,exports.Observer=Observer,exports.Pending=Pending,exports.Post=Post,exports.Promises=Promises,exports.PropChains=PropChains,exports.Put=Put,exports.Reflections=Reflections,exports.Request=Request,exports.Storages=Storages,exports.StoreTools=StoreTools,exports.Strings=Strings,exports.Switcher=Switcher,exports.Validation=Validation}));
